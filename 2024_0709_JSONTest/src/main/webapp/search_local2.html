<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<style type="text/css">

	#box {
		width: 1000px;
		margin: auto;
		margin-top: 50px;
	}
</style>

<script type="text/javascript">

	let latitude;  // 위도
	let longitude; // 경도

	// window.onload
	$(document).ready(function(){
		// 현재위치 구하기
		getLocation();
	});
	
	function getLocation() {
		  if (navigator.geolocation) {
		    navigator.geolocation.getCurrentPosition(function(position){
		    	
		    	latitude = position.coords.latitude;
				longitude = position.coords.longitude;
		    });
		  } else {
		    alert("Geolocation is not supported by this browser.");
		  }
	}
	// 밑의 함수를 하나로 합쳐놓은 것이다.
	
/* 	function getLocation() {
		  if (navigator.geolocation) {
		    navigator.geolocation.getCurrentPosition(showPosition);
		  } else {
		    alert("Geolocation is not supported by this browser.");
		  }
		}
	
		function showPosition(position) {
		  latitude = position.coords.latitude;
		  longitude = position.coords.longitude;
		  console.log("latitude", latitude);
		  console.log("longitude", longitude);
		} */
		
	function search() {
		let keyword = $("#keyword").val().trim();
		let page = $("#page").val();
		let size = $("#size").val();
		let radius = $("#radius").val();
		
		if(keyword=='') {
			alert("입력 하셔야지요");
			$("#keyword").val("");
			$("#keyword").focus();
			return;
		}
		
		// Ajax요청
		$.ajax({
			url			:	"search2.do", // KakaoSearchAction
			data		:	{
							"query":keyword,"page":page,
							"size":size,"radius":radius,
							"latitude":latitude,"longitude":longitude
							},
			success		:	function(res_data){
				$("#disp").html(res_data);
			},
			error		:	function(err){
				alert(err.responseText);
			}
		});
		
	}

</script>
</head>
<body>
<form class="form-inline">
	<div id="box">
		검색어:<input class="form-control" id="keyword">
		<input class=" btn btn-primary" type="button" value="검색" onclick="search();">
		
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		페이지: <select class="form-control" id="page">
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4">4</option>
			<option value="5">5</option>
		</select>
		
		페이지당 건수: <select class="form-control" id="size">
			<option value="5">5</option>
			<option value="10">10</option>
			<option value="15">15</option>
		</select>
		
		반경: <select class="form-control" id="radius">
			<option value="1000">1000m</option>
			<option value="500">500m</option>
			<option value="5000">5000m</option>
		</select>
</form>
		<hr>
		<div id="disp"></div>
	</div>
</body>
</html>