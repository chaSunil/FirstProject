<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="auction">

	<select id="auction_list" resultType="auction">
		select * from auction_list_view
	</select>
	
	
	
	<insert id="auction_insert" parameterType="vo.AuctionVo">
		insert into auction values(
									seq_auction_idx.nextVal,
									#{ a_initial_price },
									#{ a_direct_price },
									sysdate,
									#{ a_selltime },
									null,
									'y',
									#{ item_idx },
									#{ mem_idx },
									#{ mem_name },
									#{ mem_point }
								   )	
	</insert>
	
	
	<update id="update_gumae" parameterType="int">
		update auction set a_sledding = 'n'
		where item_idx = #{ item_idx }
	</update>
	
	
	<update id="update_price" parameterType="Map">
		update auction set a_initial_price = #{ a_initial_price }
		where item_idx = #{ item_idx }
	</update>
	
	
	
	<!-- 판매 마감시간 결정하기 -->
	<update id="update_endtime" parameterType="int">
		UPDATE auction
		SET a_endtime = a_regtime + 
		    CASE
		        WHEN a_selltime = '1' THEN INTERVAL '1' MINUTE
		        WHEN a_selltime = '3' THEN INTERVAL '3' MINUTE
		        WHEN a_selltime = '10' THEN INTERVAL '10' MINUTE
		        WHEN a_selltime = '15' THEN INTERVAL '15' MINUTE
		        WHEN a_selltime = '30' THEN INTERVAL '30' MINUTE
		        WHEN a_selltime = '60' THEN INTERVAL '60' MINUTE
		        ELSE NULL
		    END
		where a_idx = #{ a_idx }
	</update>
	
	

</mapper>












